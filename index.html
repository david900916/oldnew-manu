<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title>å‡ºèœé€²åº¦çœ‹æ¿</title>
  <style>
    body { font-family: sans-serif; padding: 2rem; }
    #progress { font-size: 1.25rem; }
  </style>
</head>
<body>
  <h1>ğŸ”” å‡ºèœé€²åº¦</h1>
  <div id="progress">è¼‰å…¥ä¸­â€¦</div>

  <script>
    // æ›¿æ›æˆä½ çš„ Apps Script Web App URL
    const API = 'https://script.google.com/macros/s/AKfycby-CwdGhm0K6CWPwPj1Iybputs3Clwmz7WIOE17XgziUcTt3oG_gUJR-wVqZK7EAGw_tg/exec';

    // JSONP callback
    function handle(data) {
      const idx = data.currentIndex;
      const item = data.items[idx] || { name: 'â€”', eta: 0 };
      const elapsed = Math.floor((Date.now() - new Date(data.startTime)) / 60000);
      document.getElementById('progress').innerHTML =
        `ç¬¬ <strong>${idx+1}</strong> é“ï¼š${item.name}<br>` +
        `å·²ç”¨ <strong>${elapsed}</strong> åˆ†é˜ï¼Œé ä¼° ${item.eta} åˆ†é˜`;
    }

    // å‹•æ…‹æ’å…¥ JSONP <script>
    function fetchProgress() {
      const s = document.createElement('script');
      s.src = `${API}?action=status&callback=handle&ts=${Date.now()}`;
      document.body.appendChild(s);
      // ç”¨å®Œå¯ç§»é™¤ï¼Œé¿å…æª”æ¡ˆç´¯ç©
      s.onload = () => document.body.removeChild(s);
    }

    // åˆæ¬¡è¼‰å…¥èˆ‡æ¯åˆ†é˜æ›´æ–°
    window.onload = fetchProgress;
    setInterval(fetchProgress, 60 * 1000);
  </script>
</body>
</html>

